local problematic_executors = {"JJsploit", "bunni", "delta"} -- Only truly unstable ones
local isProblematic = false
for _, bad in ipairs(problematic_executors) do
    if executor:lower():find(bad:lower()) then
        isProblematic = true
        break
    end
end

local function cleanupOld()
    local player = game.Players.LocalPlayer
    if not player or not player.PlayerGui then return end
    
    local guisToDestroy = {"AzureWarningUI", "AzureLoadingUI", "AzureUI", "CancelAFK"}
    for _, name in ipairs(guisToDestroy) do
        pcall(function()
            local gui = player.PlayerGui:FindFirstChild(name)
            if gui then gui:Destroy() end
        end)
    end
    
    pcall(function()
        local itemsFolder = workspace:FindFirstChild("Item_Spawns") and workspace.Item_Spawns:FindFirstChild("Items")
        if itemsFolder then
            for _, v in pairs(itemsFolder:GetChildren()) do
                local hl = v:FindFirstChild("ItemESP")
                if hl then hl:Destroy() end
                local bb = v:FindFirstChild("ItemESPName")
                if bb then bb:Destroy() end
            end
        end
    end)
    
    pcall(function()
        for _, plr in pairs(game.Players:GetPlayers()) do
            if plr.Character then
                local hl = plr.Character:FindFirstChild("PlayerESP")
                if hl then hl:Destroy() end
                local bb = plr.Character:FindFirstChild("PlayerESPName")
                if bb then bb:Destroy() end
            end
        end
    end)
    
    pcall(function()
        if player.Character then
            for _, part in ipairs(player.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = true
                end
            end
            local hrp = player.Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                for _, child in ipairs(hrp:GetChildren()) do
                    if child:IsA("BodyVelocity") or child:IsA("BodyGyro") then
                        child:Destroy()
                    end
                end
            end
        end
    end)
    
    pcall(function()
        game.Lighting.Brightness = 1
        game.Lighting.ClockTime = 14
        game.Lighting.FogEnd = 100000
        game.Lighting.GlobalShadows = true
        game.Lighting.Ambient = Color3.fromRGB(128, 128, 128)
    end)
end

cleanupOld()

if isProblematic then
    pcall(function()
        local warningGui = Instance.new("ScreenGui")
        warningGui.Name = "DiabloWarningUI"
        warningGui.Parent = game.Players.LocalPlayer.PlayerGui
        warningGui.ResetOnSpawn = false
        warningGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
        
        local warningFrame = Instance.new("Frame")
        warningFrame.BackgroundTransparency = 0.2
        warningFrame.BorderSizePixel = 0
        warningFrame.Position = UDim2.new(0.5, -250, 0.5, -120)
        warningFrame.Size = UDim2.new(0, 500, 0, 240)
        warningFrame.Parent = warningGui
        
        local gradient = Instance.new("UIGradient")
        gradient.Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, Color3.fromRGB(40, 40, 40)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 20, 20))
        }
        gradient.Rotation = 45
        gradient.Parent = warningFrame
        
        local UICornerWarning = Instance.new("UICorner")
        UICornerWarning.CornerRadius = UDim.new(0.08, 0)
        UICornerWarning.Parent = warningFrame
        
        local warningIcon = Instance.new("TextLabel")
        warningIcon.BackgroundTransparency = 1
        warningIcon.Position = UDim2.new(0.5, -30, 0, 20)
        warningIcon.Size = UDim2.new(0, 60, 0, 60)
        warningIcon.Font = Enum.Font.SourceSansBold
        warningIcon.Text = "⚠️"
        warningIcon.TextColor3 = Color3.fromRGB(255, 200, 0)
        warningIcon.TextSize = 48
        warningIcon.Parent = warningFrame
        
        local warningLabel = Instance.new("TextLabel")
        warningLabel.BackgroundTransparency = 1
        warningLabel.Position = UDim2.new(0, 20, 0, 90)
        warningLabel.Size = UDim2.new(1, -40, 0, 100)
        warningLabel.Font = Enum.Font.GothamBold
        warningLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        warningLabel.TextSize = 22
        warningLabel.TextWrapped = true
        warningLabel.Text = "⚠️ EXECUTOR WARNING ⚠️\n\nYour executor may have compatibility issues. Some features might not work."
        warningLabel.TextXAlignment = Enum.TextXAlignment.Center
        warningLabel.Parent = warningFrame
        
        wait(5)
        warningGui:Destroy()
    end)
end
